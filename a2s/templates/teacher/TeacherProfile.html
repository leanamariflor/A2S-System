{% extends "teacher/teacher_base.html" %}
{% load static %}

{% block title %}Teacher Profile - A2S{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/teacher/teacher_profile.css' %}">
{% endblock %}

{% block content %}
<div class="profile-page-container">
    <div class="manage-card">
        <div class="header-info" style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h1>Teacher Profile</h1>
                <p>Manage your account information</p>
            </div>
            <button id="edit-profile-button" class="edit-profile-button">
                <i data-lucide="edit"></i> Edit Profile
            </button>
        </div>
    </div>

    <div id="profile-container" class="read-only"
        data-upload-url="{% url 'UploadProfilePicture' %}"
        data-update-profile-url="{% url 'UpdateTeacherProfile' %}"
        data-csrf-token="{{ csrf_token }}">

        <!-- Tabs -->
        <div class="tabs">
            <div class="tab-list">
                <button class="tab-trigger active" data-tab="personal">Personal Info</button>
                <button class="tab-trigger" data-tab="academic">Academic Info</button>
                <button class="tab-trigger" data-tab="achievements">Achievements</button>
            </div>

            <!-- PERSONAL INFO -->
            <div class="tab-content active" id="personal">
                <div class="profile-grid">
                    
                    <!-- Profile Picture Card -->
                    <div class="profile-info-card">
                        <div class="profile-picture-card">
                            <div class="profile-picture-wrapper" style="position: relative;">
                                <div class="profile-picture" id="profile-picture">
                                    {% if profile_picture_url %}
                                        <img src="{{ profile_picture_url }}" alt="Profile Picture">
                                    {% else %}
                                        <i data-lucide="user"></i>
                                    {% endif %}
                                </div>

                                <input type="file" id="profile-picture-input" style="display:none;">
                                <button id="edit-profile-pic-button" class="edit-profile-pic-button" 
                                        style="position: absolute; bottom: 5px; right: 5px; display: none;">
                                    <i data-lucide="edit-2"></i>
                                </button>
                            </div>

                            <h2 class="profile-name" data-field="full_name">{{ first_name }} {{ last_name }}</h2>
                            <div class="profile-badge" data-field="dept_position">
                                {{ department|default:"-" }} â€¢ {{ position|default:"-" }}
                            </div>
                        </div>
                    </div>

                    <!-- Contact Info -->
                    <div class="contact-card">
                        <h3 class="card-title"><i data-lucide="mail"></i> Contact Information</h3>

                        <div class="form-field">
                            <label>First Name</label>
                            <p class="field-value" data-field="first_name">{{ first_name }}</p>
                            <div class="editable-field"><input type="text" name="first_name" value="{{ first_name }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Last Name</label>
                            <p class="field-value" data-field="last_name">{{ last_name }}</p>
                            <div class="editable-field"><input type="text" name="last_name" value="{{ last_name }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Email</label>
                            <p class="field-value" data-field="email">{{ email }}</p>
                        </div>

                        <div class="form-field">
                            <label>Phone Number</label>
                            <p class="field-value" data-field="phone">{{ phone|default:'' }}</p>
                            <div class="editable-field"><input type="text" name="phone" value="{{ phone }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Address</label>
                            <p class="field-value" data-field="address">{{ address|default:'' }}</p>
                            <div class="editable-field"><input type="text" name="address" value="{{ address }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Date of Birth</label>
                            <p class="field-value" data-field="dob">{{ dob_display }}</p>
                            <div class="editable-field"><input type="date" name="dob" value="{{ dob|date:'Y-m-d' }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Bio</label>
                            <p class="field-value" data-field="bio">{{ bio|default:'' }}</p>
                            <div class="editable-field"><textarea name="bio">{{ bio }}</textarea></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ACADEMIC INFO -->
            <div class="tab-content" id="academic">
                <div class="academic-grid">
                    <div class="card">
                        <h3 class="card-title"><i data-lucide="graduation-cap"></i> Academic Details</h3>

                        <div class="form-field">
                            <label>Teacher ID</label>
                            <p class="field-value" data-field="teacher_id">{{ teacher_id|default:'-' }}</p>
                        </div>

                        <div class="form-field">
                            <label>Department</label>
                            <p class="field-value" data-field="department">{{ department|default:'-' }}</p>
                            <div class="editable-field">
                                <select name="department" class="styled-select">
                                    <option value="CCS" {% if department == "CCS" %}selected{% endif %}>Computer Studies (CCS)</option>
                                    <option value="CEA" {% if department == "CEA" %}selected{% endif %}>Engineering & Architecture (CEA)</option>
                                    <option value="CASE" {% if department == "CASE" %}selected{% endif %}>Arts, Sciences & Education (CASE)</option>
                                    <option value="CMBA" {% if department == "CMBA" %}selected{% endif %}>Business & Accountancy (CMBA)</option>
                                    <option value="CNAHS" {% if department == "CNAHS" %}selected{% endif %}>Nursing & Allied Health Sciences (CNAHS)</option>
                                    <option value="CCJ" {% if department == "CCJ" %}selected{% endif %}>Criminal Justice (CCJ)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-field">
                            <label>Specialization</label>
                            <p class="field-value" data-field="specialization">{{ specialization|default:'N/A' }}</p>
                            <div class="editable-field"><input type="text" name="specialization" value="{{ specialization }}"></div>
                        </div>

                        <div class="form-field">
                            <label>Date Joined</label>
                            <p class="field-value" data-field="date_joined">{{ date_joined|default:'-' }}</p>
                        </div>

                        <div class="form-field">
                            <label>Position</label>
                            <p class="field-value" data-field="position">{{ position|default:'Full-Time Faculty' }}</p>
                            <div class="editable-field">
                                <select name="position" class="styled-select">
                                    <option value="Full-Time Faculty" {% if position == "Full-Time Faculty" %}selected{% endif %}>Full-Time Faculty</option>
                                    <option value="Part-Time Faculty" {% if position == "Part-Time Faculty" %}selected{% endif %}>Part-Time Faculty</option>
                                    <option value="Visiting Lecturer" {% if position == "Visiting Lecturer" %}selected{% endif %}>Visiting Lecturer</option>
                                    <option value="Adjunct Faculty" {% if position == "Adjunct Faculty" %}selected{% endif %}>Adjunct Faculty</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i data-lucide="book-open"></i> Teaching Load</h3>

                        <div class="form-field">
                            <label>Courses Handled</label>
                            <p class="field-value" data-field="total_courses">{{ total_courses|default:0 }}</p>
                        </div>

                        <div class="form-field">
                            <label>Total Students</label>
                            <p class="field-value" data-field="total_students">{{ total_students|default:0 }}</p>
                        </div>

                    </div>
                </div>
            </div>

            <!-- ACHIEVEMENTS -->
            <div class="tab-content" id="achievements">
                <div class="card">
                    <h3 class="card-title"><i data-lucide="award"></i> Professional Achievements</h3>
                    <div class="achievements-grid" id="achievements-container">
                        {% for achievement in achievements %}
                        <div class="achievement-card" data-field="achievement_{{ forloop.counter }}">
                            <i data-lucide="{{ achievement.icon }}"></i>
                            <h4>{{ achievement.title }}</h4>
                            <div class="editable-field">
                                <input type="text" name="achievement_{{ forloop.counter }}_title" value="{{ achievement.title }}">
                                <input type="text" name="achievement_{{ forloop.counter }}_description" value="{{ achievement.description }}">
                            </div>
                            <p>{{ achievement.description }}</p>
                        </div>
                        {% empty %}
                        <p>No achievements yet.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Action Buttons -->
    <div class="profile-actions" style="display: none;" id="profile-actions">
        <button id="save-profile-button" class="save-button">Save Changes</button>
        <button id="cancel-profile-button" class="cancel-button">Cancel</button>
    </div>
</div>

<script src="{% static 'js/teacher/TeacherProfile.js' %}"></script>
{% endblock %}
