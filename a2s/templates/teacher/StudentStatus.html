{% extends "teacher/teacher_base.html" %}
{% load static %}

{% block title %}Student Status{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/teacher/status.css' %}">
{% endblock %}

{% block content %}
<div class="student-status-page">
    <!-- Header -->
    <div class="header-card">
        <h2>Name: {{ full_name }}</h2>
        <p>Student ID: {{ student_number }}</p>
        <p>Email: {{ username }}</p>
    </div>
    <div class="back-btn-container">
    <a href="{% url 'teacher_classlist' course_code=course_code section=section %}" class="back-btn">‚Üê Back to Class List</a>
    </div>
    <div class="export-btn-container">
    <a href="{% url 'export_student_report' student_id=student_id %}" class="view-btn">Export Report</a>
    </div>


    <div class="main-content">
        <div class="left-panel">
            <h3>Grades</h3>
            <table class="student-grade-table">
                <thead>
                    <tr>
                        <th>Course Code</th>
                        <th>Course Name</th>
                        <th>Midterm</th>
                        <th>Final Grade</th>
                        <th>Remarks</th>
                        <th>Semester</th>
                        <th>School Year</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for g in grades %}
                    <tr data-grade-id="{{ g.id }}">
                        <td>{{ g.course_code }}</td>
                        <td>{{ g.course_name }}</td>
                        <td>{{ g.midterm|default:"-" }}</td>
                        <td>{{ g.final_grade|default:"-" }}</td>
                        <td>{{ g.remarks|default:"-" }}</td>
                        <td>{{ g.semester }}</td>
                        <td>{{ g.school_year }}</td>
                        <td class="note-text">
                            {% if g.notes %}
                                {{ g.notes }}
                            {% else %}
                                <span class="no-notes">No notes yet</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="9">No grades found for this student.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

           <div id="advisor-notes-container"
            data-update-url="{% url 'update_student_notes' student_id=student_id %}"
            data-csrf-token="{{ csrf_token }}">
            <h3>Advisor Notes</h3>
            <span id="advisorNoteText">
                {% if grades.0.notes %}
                    {{ grades.0.notes }}
                {% else %}
                    No notes for this student yet.
                {% endif %}
            </span>
            <textarea id="advisorNoteEdit" style="display:none;" rows="4"></textarea>
            <button id="editAdvisorNoteBtn">Edit</button>
            <button id="saveAdvisorNoteBtn" style="display:none;">Save</button>
        </div>
        </div>
    </div>
</div>


<script src="{% static 'js/teacher/student_status.js' %}"></script>

{% endblock %}
